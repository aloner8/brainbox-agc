
<div class ="around"   >
   <div align="center">
    <ng-container *ngIf="modeImport==false && modeImportCoordinator==false && modeImportApprover==false">
      <!-- <button mat-raised-button color="primary" style="margin-right: 20px;" ><mat-icon class="material-symbols-outlined"  >add_circle</mat-icon>New User</button> -->
      <button mat-raised-button color="basic" style="margin-right: 20px;" ><mat-icon class="material-symbols-outlined"  >upload</mat-icon>
         
         <ngx-dropzone  accept="excel/xlsx/xls,.xlsx,.xls" [disabled] ="!IsAdmin" (change)="onSelectNext($event)" [expandable]="false"   style="height:40px; width: 100%; overflow: hidden; background-color:transparent; border-color: transparent;"  [style.Color]="IsAdmin?'blue':'gray'"   >
          <ngx-dropzone-label>           
            Import User data   
          </ngx-dropzone-label>
    
        </ngx-dropzone>
      </button>
      <button mat-raised-button color="basic" style="margin-right: 20px;" ><mat-icon class="material-symbols-outlined"  >upload</mat-icon> 
        <ngx-dropzone  accept="excel/xlsx/xls,.xlsx,.xls" [disabled] ="!IsAdmin" (change)="onSelect($event)" [expandable]="false"   style="height:40px; width: 100%; overflow: hidden; background-color:transparent;border-color: transparent; "  [style.Color]="IsAdmin?'blue':'gray'"   >
          <ngx-dropzone-label>           
            Import Coordinator
          </ngx-dropzone-label>
    
        </ngx-dropzone>
        </button>
          <button mat-raised-button color="basic" style="margin-right: 20px;" ><mat-icon class="material-symbols-outlined"  >upload</mat-icon> 
        <ngx-dropzone  accept="excel/xlsx/xls,.xlsx,.xls" [disabled] ="!IsAdmin" (change)="onSelectApprover($event)" [expandable]="false"   style="height:40px; width: 100%; overflow: hidden; background-color:transparent;border-color: transparent; "  [style.Color]="IsAdmin?'blue':'gray'"   >
          <ngx-dropzone-label>           
            Import Approver
          </ngx-dropzone-label>
    
        </ngx-dropzone>
        </button>
        <span>
          <mat-form-field  appearance="outline" style="text-align: right; width:40%; " >
            <mat-icon class="material-symbols-outlined" matSuffix >search</mat-icon>
            <input matInput (keyup)="applyFilter($event)"  [(ngModel)]="filterinput" placeholder="Search" #input_search  style="color: white;" >
            <mat-label matSuffix >Search (look in Fullname and Division)</mat-label>
          </mat-form-field>
        </span>
    </ng-container>
    <ng-container *ngIf="modeImport">
    
      <button mat-raised-button color="primary" style="margin-right: 20px;"  (click)="ConfirmImport()" ><mat-icon class="material-symbols-outlined"  >add_circle</mat-icon>Confirm Import</button>
    <button mat-raised-button color="accent" style="margin-right: 20px;"  (click)="CancelImport()" ><mat-icon class="material-symbols-outlined"  >cancel</mat-icon> Cancel </button>
    <span>
      <mat-checkbox  color="accent" [(ngModel)]="showImportAll" (change)="changeshowImportAll()" >Show All</mat-checkbox>
    </span>

    </ng-container>
    
    <ng-container *ngIf="modeImportCoordinator">
    
      <button mat-raised-button color="primary" style="margin-right: 20px;"  (click)="ConfirmImportCoordinator()" ><mat-icon class="material-symbols-outlined"  >add_circle</mat-icon>Confirm Update Coordinator</button>
    <button mat-raised-button color="accent" style="margin-right: 20px;"  (click)="CancelImport()" ><mat-icon class="material-symbols-outlined"  >cancel</mat-icon> Close </button>
   

    </ng-container>
        <ng-container *ngIf="modeImportApprover">
    
      <button mat-raised-button color="primary" style="margin-right: 20px;"  (click)="ConfirmImportApprover()" ><mat-icon class="material-symbols-outlined"  >add_circle</mat-icon>Confirm Update Approver</button>
    <button mat-raised-button color="accent" style="margin-right: 20px;"  (click)="CancelImport()" ><mat-icon class="material-symbols-outlined"  >cancel</mat-icon> Close </button>
   

    </ng-container>
 
   </div>
  
      <div   #divmport style="width: 1400px;height: 500px; overflow: scroll;" >

      <table *ngIf="modeImport==false && modeImportCoordinator==false && modeImportApprover==false"  mat-table [dataSource]="dataSource" matSort #tabledetail  (matSortChange)="sortData($event)" >

        <!-- ID Column -->
        <ng-container matColumnDef="running">
          <th mat-header-cell *matHeaderCellDef > # </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" >
             <a  class="runnumber" (click)="OpenDetail(row.project_id)" >  {{row.running}} </a>
            </td>
        </ng-container>
    
        <!-- Progress Column -->
        <ng-container matColumnDef="fullname">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> fullname</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.fullname}} </td>
        </ng-container>
    
        <!-- Fruit Column -->
        <ng-container matColumnDef="division">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.division}} </td>
        </ng-container>
        <ng-container matColumnDef="level">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> level </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.level}} </td>
        </ng-container>
        <ng-container matColumnDef="totalideas">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> totalideas </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.totalideas}} </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef > actions </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> 
            <button   mat-button (click)="OpenDetail(row.value)">
            <mat-icon style="color: white;">edit_square</mat-icon>            
            </button>
          </td>
        </ng-container>
    
        <tr mat-header-row *matHeaderRowDef="displayedColumns;sticky: true" style=" border-color: white;background-color: rgba(9, 47, 146, 0.741); " ></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" [style.border-bottom]="'0.5px solid gray'"></tr>
    
        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow >
          <td class="mat-cell" colspan="4" >No data matching the filter "{{filterinput}}"</td>
        </tr>
      </table>
      <table *ngIf="modeImport" mat-table [dataSource]="importDataSource" matSort #tableImport  (matSortChange)="sortData($event)"  >
       
        <!-- ID Column -->
        <ng-container matColumnDef="seq">
          <th mat-header-cell *matHeaderCellDef > # </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" >
             {{row.seq}}
            </td>
        </ng-container>
 

        <!-- Progress Column -->
        <ng-container matColumnDef="emp_num">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> emp_num</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.emp_num}} </td>
        </ng-container>
    
        <!-- Fruit Column -->
        <ng-container matColumnDef="emp_name_en">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>emp_name_en</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.emp_name_en}} </td>
        </ng-container>
    
        <!-- Progress Column -->
        <ng-container matColumnDef="status_detail" >
          <th mat-header-cell *matHeaderCellDef mat-sort-header  style="min-width: 400px;"> detail</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.status_detail}} </td>
        </ng-container>
        
         <!-- Progress Column -->
         <ng-container matColumnDef="emp_status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> emp_status</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.emp_status}} </td>
        </ng-container>
    
        <!-- Fruit Column -->
        <ng-container matColumnDef="location">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>location</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.location}} </td>
        </ng-container>
    
        <!-- Progress Column -->
        <ng-container matColumnDef="division">
          <th mat-header-cell *matHeaderCellDef mat-sort-header> division</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.division}} </td>
        </ng-container>
                    
        <ng-container matColumnDef="approver">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> approver </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.approver}} </td>
        </ng-container>
        

        <ng-container matColumnDef="job_level">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> job_level </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.job_level}} </td>
        </ng-container>

        <ng-container matColumnDef="is_new_emp">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> is_new_emp </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.is_new_emp=='1'" disabled > 
            </mat-checkbox> 
          </td>
        </ng-container>
      
        <ng-container matColumnDef="status_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> status</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.status_update" disabled > 
            </mat-checkbox> 
          </td>
        </ng-container>
        <ng-container matColumnDef="location_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;">location</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.location_update" disabled > 
            </mat-checkbox> 
          </td>
        </ng-container>
        <ng-container matColumnDef="devision_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;">division</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.devision_update" disabled > 
            </mat-checkbox> 
          </td>
        </ng-container>
        <ng-container matColumnDef="approver_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> default approver </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.approver_update" disabled> 
            </mat-checkbox> 
          </td>
        </ng-container>
        <ng-container matColumnDef="isapprover_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> isapprover</th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.isapprover_update" disabled> 
            </mat-checkbox> 
          </td>
        </ng-container>
        <ng-container matColumnDef="devision_new">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> division_new </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.devision_new=='0'" disabled> 
            </mat-checkbox> 
          </td>
        </ng-container>
 
        <ng-container matColumnDef="email_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> email_update </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.email_update=='1'" disabled> 
            </mat-checkbox> 
          </td>
        </ng-container>
                <ng-container matColumnDef="name_update">
          <th mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 110px;"> name_update </th>
          <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle">
            <mat-checkbox  [checked]="row.name_update=='1'" disabled> 
            </mat-checkbox> 
          </td>
        </ng-container>

    
        <tr mat-header-row *matHeaderRowDef="ImportColumns;sticky: true" style=" border-color: white;background-color: rgba(9, 47, 146, 0.741); " ></tr>
        <tr mat-row *matRowDef="let row; columns: ImportColumns;" [style.border-bottom]="'0.5px solid gray'"></tr>
    
        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow >
          <!-- <td class="mat-cell" colspan="4" >No data matching the filter "{{filterinput}}"</td> -->
        </tr>
      </table>
    
    <table *ngIf="modeImportCoordinator" style="width: 1000px;"  mat-table [dataSource]="importCoordinatorDataSource" matSort #tableImport  (matSortChange)="sortData($event)"  >
     
      <!-- ID Column -->
      <ng-container matColumnDef="Division">
        <th mat-header-cell *matHeaderCellDef > # </th>
        <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" >
           {{row.Division}}
          </td>
      </ng-container>


      <!-- Progress Column -->
      <ng-container matColumnDef="MTP1">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> MTP1</th>
        <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.MTP1}} </td>
      </ng-container>
  
      <!-- Fruit Column -->
      <ng-container matColumnDef="MTP2">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>MTP2</th>
        <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle"> {{row.MTP2}} </td>
      </ng-container>
  
      <!-- Progress Column -->
      <ng-container matColumnDef="PPD" >
        <th mat-header-cell *matHeaderCellDef mat-sort-header> PPD</th>
        <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.PPD}} </td>
      </ng-container>
      
       <!-- Progress Column -->
       <ng-container matColumnDef="BKK">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> BKK</th>
        <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'"> {{row.BKK}} </td>
      </ng-container>
  
       <!-- Progress Column -->
       <ng-container matColumnDef="detail">
        <th mat-header-cell *matHeaderCellDef    style="min-width: 400px;"> </th>
        <td mat-cell *matCellDef="let row" [style.border-bottom]="rowboderstyle" [style.border-bottom]="'0.5px solid gray'">{{row.detail}} </td>
      </ng-container>


  
      <tr mat-header-row *matHeaderRowDef="ImportColumnsCoordinator;sticky: true" style=" border-color: white;background-color: rgba(9, 47, 146, 0.741); " ></tr>
      <tr mat-row *matRowDef="let row; columns: ImportColumnsCoordinator;" [style.border-bottom]="'0.5px solid gray'"></tr>
  
      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow >
        <!-- <td class="mat-cell" colspan="4" >No data matching the filter "{{filterinput}}"</td> -->
      </tr>
    </table>
 
<table *ngIf="modeImportApprover"
       mat-table
       [dataSource]="importApproverDataSource"
       matSort
       #tableImport
       (matSortChange)="sortData($event)"
       style="width: 1000px;">
  
  <ng-container matColumnDef="empCode">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Employee Number</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.empCode}}</td>
  </ng-container>

  <ng-container matColumnDef="empName">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Employee Name EN</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.empName}}</td>
  </ng-container>

  <ng-container matColumnDef="Location">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Location</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.Location}}</td>
  </ng-container>

  <ng-container matColumnDef="Division">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.Division}}</td>
  </ng-container>

  <ng-container matColumnDef="empApprover">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver Code</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.empApprover}}</td>
  </ng-container>

<!--   <ng-container matColumnDef="ApproverName">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Approver Name</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.ApproverName}}</td>
  </ng-container> -->

  <ng-container matColumnDef="detail">
    <th mat-header-cell *matHeaderCellDef style="min-width: 400px;">Detail</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.detail}}</td>
  </ng-container>
    <ng-container matColumnDef="isapprover_update">
    <th mat-header-cell *matHeaderCellDef style="min-width: 400px;">isapprover_update</th>
    <td mat-cell *matCellDef="let row" [style.border-bottom]="'0.5px solid gray'">{{row.isapprover_update}}</td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="ImportColumnsApprover; sticky: true"
      style="border-color: white; background-color: rgba(9, 47, 146, 0.741);"></tr>

  <tr mat-row *matRowDef="let row; columns: ImportColumnsApprover;"
      [style.border-bottom]="'0.5px solid gray'"></tr>

  <tr class="mat-row" *matNoDataRow>
    <td class="mat-cell" colspan="7">No data matching the filter "{{filterinput}}"</td>
  </tr>
</table>
    </div>
      


    <mat-paginator  *ngIf="modeImport==false && modeImportCoordinator==false && modeImportApprover==false"   [pageSizeOptions]="[ 20, 50,100]" aria-label="Select page of myhome ['my_ideas']" (page)="paginatorChange($event)"></mat-paginator>
    <!-- <mat-paginator  *ngIf="modeImport"  [pageSizeOptions]="[ 20, 50,100]" aria-label="Select page of importData" (page)="ImportpaginatorChange($event)"></mat-paginator> -->
  </div>
  